(function () {
    function injectScript(src, where) {
        var elm = document.createElement('script');
        elm.src = src;
        document[where || 'head'].appendChild(elm);
    }

    function generateScriptData(source) {
        var b64 = 'data:text/javascript';
        // base64 may be smaller, but does not handle unicode characters
        // attempt base64 first, fall back to escaped text
        try {
            b64 += (';base64,' + btoa(source));
        } catch (e) {
            b64 += (';charset=utf-8,' + encodeURIComponent(source));
        }
        return b64;
    }

    var website = location.protocol + '//' + location.host;
    chrome.storage.sync.get(website, function (obj) {
        var customjs = obj[website];

        if (customjs) {
            // base.js to provide useful functions
            injectScript(chrome.extension.getURL('js/base.js'), 'body');

            var source = `var autoType = `;
            source += customjs.config.autoType;
            source += `; var betAmount = `;
            source += customjs.config.betAmount;
            source += `; var maxBetAmount = `;
            source += customjs.config.maxBetAmount;
            source += `; var maxLost = `;
            source += customjs.config.maxLost;
            source += `;`;
            source = generateScriptData(source);
            setTimeout(function () {
                injectScript(source, 'body');
            }, 250);

            var source_bot = "data:text/javascript;base64,ZnVuY3Rpb24gc3RhcnRCb3QoKXskKCIjc3RhcnRfYm90IikuaGlkZSgpLCQoIiNzdG9wX2JvdCIpLnNob3coKSxzdGFydHRpbWU9KG5ldyBEYXRlKS5nZXRUaW1lKCksYmVnaW5nYmFsPSQoIiNiYWxhbmNlIikudGV4dCgpLHN0YXJ0YmFsYW5jZT0kKCIjYmFsYW5jZSIpLnRleHQoKSxzdGFydFZhbHVlPWJldEFtb3VudCxNYXhpbXVtVmFsdWU9bWF4QmV0QW1vdW50LG9sZGJldD1zdGFydFZhbHVlLGhhbmRicmFrZT1NYXhpbXVtVmFsdWUscm91bmQ9MCxnYW1lTG9zdD0wLGdhbWVXaW49MCxjb25zb2xlLmxvZygiR2FtZSBzdGFydGVkISIpLHJlc2V0KCksKCRhdXRvQnV0dG9uPTA9PWF1dG9UeXBlPyRoaUJ1dHRvbjokbG9CdXR0b24pLnRyaWdnZXIoImNsaWNrIil9ZnVuY3Rpb24gc3RhcnRHYW1lMih0KXskKCIjc3RhcnRfYm90IikuaGlkZSgpLCQoIiNzdG9wX2JvdCIpLnNob3coKSxzdGFydHRpbWU9KG5ldyBEYXRlKS5nZXRUaW1lKCksc3RvcHBlZD0hMSxvbGRiZXQ9c3RhcnRWYWx1ZSxoYW5kYnJha2U9TWF4aW11bVZhbHVlLHJvdW5kPTAsZ2FtZUxvc3Q9MCxnYW1lV2luPTAsY29uc29sZS5sb2coIkdhbWUgc3RhcnRlZCEiKSxyZXNldCgpLCRhdXRvQnV0dG9uPTA9PWF1dG9UeXBlPyRoaUJ1dHRvbjokbG9CdXR0b24sJGxvQnV0dG9uLnRyaWdnZXIoImNsaWNrIil9ZnVuY3Rpb24gc3RvcEJvdCgpeyQoIiNzdG9wX2JvdCIpLmhpZGUoKSwkKCIjc3RhcnRfYm90Iikuc2hvdygpLGNvbnNvbGUubG9nKCJHYW1lIHdpbGwgc3RvcCBzb29uISBMZXQgbWUgZmluaXNoLiIpLHN0b3BwZWQ9ITAsc3RhcnRWYWx1ZT1vbGRiZXQsaGFuZGJyYWtlPU1heGltdW1WYWx1ZX1mdW5jdGlvbiByZXNldCgpe3JvdW5kJTEwMD09MCYmMCE9cm91bmQmJihzdGFydFZhbHVlPSgxKnN0YXJ0VmFsdWUpLnRvRml4ZWQoOCksY29uc29sZS5sb2coIlJvdW5kICIrcm91bmQrIjogYmV0IGNoYW5nZSBmb3IgIitzdGFydFZhbHVlKSksJCgiI2RvdWJsZV95b3VyX2J0Y19zdGFrZSIpLnZhbChzdGFydFZhbHVlKX1mdW5jdGlvbiByb3VuZG51bWIoKXtjb25zb2xlLmNsZWFyKCkscm91bmQrPTEsdGltZVJlbWFpbmluZygpLGJlZ2luaW5nQmFsKCkscmV3YXJkc0JhbCgpLGxvdHRlcnlCYWwoKSxjb25zb2xlLmxvZygiUm91bmQgIyIrcm91bmQpO3ZhciB0PSQoIiNiYWxhbmNlIikudGV4dCgpLGU9KE51bWJlcih0KS1OdW1iZXIoc3RhcnRiYWxhbmNlKSkudG9GaXhlZCg4KTtjb25zb2xlLmxvZygiUHJvZml0OiIrZSsiIEJpdGNvaW4iKX1mdW5jdGlvbiB0aW1lUmVtYWluaW5nKCl7dGltZVI9JCgidGl0bGUiKS50ZXh0KCkscmVwbFRleHQ9dGltZVIucmVwbGFjZSgiLSBGcmVlQml0Y28uaW4gLSBXaW4gZnJlZSBiaXRjb2lucyBldmVyeSBob3VyISIsIiIpLGNvbnNvbGUubG9nKCIlY1RpbWUgdW50aWwgZnJlZSByb2xsOiAlYyIrcmVwbFRleHQsImNvbG9yOiAjMDAwMDA7IGZvbnQtd2VpZ2h0OmJvbGQ7IiwiY29sb3I6ICMwMDdhNWM7Zm9udC13ZWlnaHQ6Ym9sZDsiKX1mdW5jdGlvbiBiZWdpbmluZ0JhbCgpe2NvbnNvbGUubG9nKCJCVEMgU3RhcnRpbmcgQmFsYW5jZTogIitiZWdpbmdiYWwpfWZ1bmN0aW9uIHJld2FyZHNCYWwoKXtjb25zb2xlLmxvZygiJWNSZXdhcmQgUG9pbnRzIEJhbGFuY2U6ICVjIityZXdhcmRwb2ludHMrIiBwb2ludHMiLCJjb2xvcjogIzAwMDAwOyIsImNvbG9yOiAjZmY5YTM2OyBmb250LXdlaWdodDogYm9sZDsiKX1mdW5jdGlvbiBsb3R0ZXJ5QmFsKCl7Y29uc29sZS5sb2coIiVjTG90dGVyeSBUaWNrZXRzIEJhbGFuY2U6ICVjIitzKyIgdGlja2V0cyIsImNvbG9yOiAjMDAwMDA7IiwiY29sb3I6ICMwMDViYjY7IGZvbnQtd2VpZ2h0OiBib2xkOyIpfWZ1bmN0aW9uIGhpZ2hlckJldCgpe2NvbnNvbGUubG9nKCJIaWdoZXN0IGJldDogIitoaWdoZXJiZXQpfWZ1bmN0aW9uIG11bHRpcGx5KCl7dmFyIHQ9KDIqJCgiI2RvdWJsZV95b3VyX2J0Y19zdGFrZSIpLnZhbCgpKS50b0ZpeGVkKDgpOyQoIiNkb3VibGVfeW91cl9idGNfc3Rha2UiKS52YWwodCksY29uc29sZS5sb2coIkJldCA9ICIrdCksaGlnaGVyYmV0PHQmJihoaWdoZXJiZXQ9dCl9ZnVuY3Rpb24gcmVhbHRpbWUodCl7dmFyIGU9cGFyc2VJbnQodCwxMCksbz1NYXRoLmZsb29yKGUvMzYwMCksbj1NYXRoLmZsb29yKChlLTM2MDAqbykvNjApLGE9ZS0zNjAwKm8tNjAqbjtyZXR1cm4gMCE9bz9vKz0iIEhvdXJzICI6bz0iIiwwIT1uP24rPSIgTWludXRlcyAiOm49IiIsYTwxMCYmKGE9YSksdD0iVGltZSBwbGF5ZWQgPSAiK28rbithKyIgU2Vjb25kcyJ9ZnVuY3Rpb24gZGVleHBvbmVudGl6ZSh0KXtyZXR1cm4gMWU2KnR9ZnVuY3Rpb24gaUhhdmVFbm91Z2hNb25pKCl7cmV0dXJuIDIqZGVleHBvbmVudGl6ZShwYXJzZUZsb2F0KCQoIiNiYWxhbmNlIikudGV4dCgpKSkvMTAwKigyKmRlZXhwb25lbnRpemUoJCgiI2RvdWJsZV95b3VyX2J0Y19zdGFrZSIpLnZhbCgpKSk+c3RvcFBlcmNlbnRhZ2UvMTAwfWZ1bmN0aW9uIGdldFJhbmRvbVdhaXQoKXt2YXIgdD1NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqbWF4V2FpdCkrMTAwO3JldHVybiBjb25zb2xlLmxvZygiV2FpdGluZyBmb3IgIit0KyJtcyBiZWZvcmUgbmV4dCBiZXQuIiksdH1mdW5jdGlvbiBzdG9wQmVmb3JlUmVkaXJlY3QoKXtyZXR1cm4gcGFyc2VJbnQoJCgidGl0bGUiKS50ZXh0KCkpPHN0b3BCZWZvcmUmJihjb25zb2xlLmxvZygiQXBwcm9hY2hpbmcgcmVkaXJlY3QhIFN0b3AgdGhlIGdhbWUgc28gd2UgZG9uJ3QgZ2V0IHJlZGlyZWN0ZWQgd2hpbGUgbG9vc2luZy4iKSxzdG9wR2FtZSgpLCEwKX1mdW5jdGlvbiBzdG9wTWF4U3Rha2UoKXtpZigkKCIjZG91YmxlX3lvdXJfYnRjX3N0YWtlIikudmFsKCk+aGFuZGJyYWtlKXtzdG9wcGVkPSEwLGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoYW5kYnJha2VhbGVydCIpLnBsYXkoKSxjb25zb2xlLmxvZygiSGFuZGJyYWtlIHRyaWdnZXJlZCEgUGxlYXNlIFdhaXQiKTt2YXIgdD01LGU9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtjb25zb2xlLmxvZygiSGlnaGVzdCBTdGFrZSBhdCAiK2hhbmRicmFrZSsiIHJlYWNoZWQiKSxjb25zb2xlLmxvZyh0KSwtMT09PS0tdCYmKGNsZWFySW50ZXJ2YWwoZSksY29uc29sZS5jbGVhcigpLGNvbnNvbGUubG9nKCJSZXN0YXJ0aW5nIEJPVCIpLGNvbnNvbGUubG9nKCJXYWl0IDUgbW9yZSBzZWNvbmRzIHNvIGl0IHdvbnQgZG91YmxlIHN0YXJ0IikpfSwxZTMpO3JldHVybiBzZXRUaW1lb3V0KHN0YXJ0R2FtZTIsNmUzKSwhMH1yZXR1cm4hMX12YXIgJGxvQnV0dG9uPSQoIiNkb3VibGVfeW91cl9idGNfYmV0X2xvX2J1dHRvbiIpLCRoaUJ1dHRvbj0kKCIjZG91YmxlX3lvdXJfYnRjX2JldF9oaV9idXR0b24iKSxiZWdpbmdiYWwsc3RhcnRiYWxhbmNlLG9sZGJldCxoYW5kYnJha2Uscm91bmQ9MCxnYW1lTG9zdD0wLGdhbWVXaW49MCxoaWdoZXJiZXQ9MCxzdGFydFZhbHVlLE1heGltdW1WYWx1ZSxzdG9wUGVyY2VudGFnZT0uMDA0LG1heFdhaXQ9MWUzLHN0b3BCZWZvcmU9MSxzdG9wcGVkPSExLHRpbWVSLHJlcGxUZXh0LGVuZHRpbWUsc3RhcnR0aW1lLHJld2FyZHBvaW50cz1kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJyZXdhcmRfdGFibGVfYm94IGJyXzBfMF81XzUgdXNlcl9yZXdhcmRfcG9pbnRzIGZvbnRfYm9sZCIpWzBdLmlubmVySFRNTDtzPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1c2VyX2xvdHRlcnlfdGlja2V0cyIpLmlubmVySFRNTCxzPXMucmVwbGFjZSgvKF5ccyopfChccyokKS9naSwiIikscz1zLnJlcGxhY2UoL1sgXXsyLH0vZ2ksIiAiKSxzPXMucmVwbGFjZSgvXG4gLywiXG4iKSxkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidXNlcl9sb3R0ZXJ5X3RpY2tldHMiKS5pbm5lckhUTUw9czt2YXIgc291bmQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYXVkaW8iKTtzb3VuZC5pZD0iaGFuZGJyYWtlYWxlcnQiLHNvdW5kLnNyYz0iaHR0cHM6Ly93d3cubWVkaWFjb2xsZWdlLmNvbS9kb3dubG9hZHMvc291bmQtZWZmZWN0cy9zdGFyLXRyZWsvdG9zL3Rvcy1jb21wdXRlci0wNS53YXYiLHNvdW5kLnByZWxvYWQ9ImF1dG8iLGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF0uYXBwZW5kQ2hpbGQoc291bmQpO3ZhciAkYXV0b0J1dHRvbixkaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7ZGl2LnN0eWxlLnBvc2l0aW9uPSJmaXhlZCIsZGl2LnN0eWxlLnRvcD0iNDAwcHgiLGRpdi5zdHlsZS5yaWdodD0wLGRpdi5pbm5lckhUTUw9JzxidXR0b24gc3R5bGU9IndpZHRoOiAxNTBweCIgb25jbGljaz0ic3RhcnRCb3QoKTsiIGlkPSJzdGFydF9ib3QiPlN0YXJ0IEJvdDwvYnV0dG9uPjxidXR0b24gc3R5bGU9IndpZHRoOiAxNTBweDtiYWNrZ3JvdW5kOiByZWQ7ZGlzcGxheTogbm9uZTsiIG9uY2xpY2s9InN0b3BCb3QoKTsiIGlkPSJzdG9wX2JvdCI+U3RvcCBCb3Q8L2J1dHRvbj4nLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTt2YXIgbF9jPTA7JCgiI2RvdWJsZV95b3VyX2J0Y19iZXRfbG9zZSIpLnVuYmluZCgpLCQoIiNkb3VibGVfeW91cl9idGNfYmV0X3dpbiIpLnVuYmluZCgpLCQoIiNkb3VibGVfeW91cl9idGNfYmV0X3dpbiIpLmJpbmQoIkRPTVN1YnRyZWVNb2RpZmllZCIsZnVuY3Rpb24odCl7aWYoJCh0LmN1cnJlbnRUYXJnZXQpLmlzKCc6Y29udGFpbnMoIndpbiIpJykpe2xfYz0wLGdhbWVXaW4rPTEscm91bmRudW1iKCksY29uc29sZS5sb2coIiVjV2luOiAiK2dhbWVXaW4rIiAlY0xvc3Q6ICIrZ2FtZUxvc3QsImNvbG9yOiAjMDA3YTVjIiwiY29sb3I6ICNGRjAwMDAiKSxlbmR0aW1lPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3ZhciBlPU1hdGguZmxvb3IoKGVuZHRpbWUtc3RhcnR0aW1lKS8xZTMpO2lmKGNvbnNvbGUubG9nKHJlYWx0aW1lKGUpKSxoaWdoZXJCZXQoKSxpSGF2ZUVub3VnaE1vbmkoKSl7aWYoY29uc29sZS5sb2coIllvdSBXT04hIikscmVzZXQoKSxzdG9wcGVkKXJldHVybiBzdG9wcGVkPSExLCExfWVsc2UgY29uc29sZS5sb2coIllvdSBXT04hICIpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXsyPT1hdXRvVHlwZSYmbF9jPj1tYXhMb3N0JiYoJGF1dG9CdXR0b249JGF1dG9CdXR0b249PSRsb0J1dHRvbj8kaGlCdXR0b246JGxvQnV0dG9uLGxfYz0wKSwkYXV0b0J1dHRvbi50cmlnZ2VyKCJjbGljayIpfSxnZXRSYW5kb21XYWl0KCkpfX0pLCQoIiNkb3VibGVfeW91cl9idGNfYmV0X2xvc2UiKS5iaW5kKCJET01TdWJ0cmVlTW9kaWZpZWQiLGZ1bmN0aW9uKHQpe2lmKCQodC5jdXJyZW50VGFyZ2V0KS5pcygnOmNvbnRhaW5zKCJsb3NlIiknKSl7bF9jKyssZ2FtZUxvc3QrPTEscm91bmRudW1iKCksY29uc29sZS5sb2coIiVjV2luOiAiK2dhbWVXaW4rIiAlY0xvc3Q6ICIrZ2FtZUxvc3QsImNvbG9yOiAjMDA3YTVjIiwiY29sb3I6ICNGRjAwMDAiKSxlbmR0aW1lPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3ZhciBlPU1hdGguZmxvb3IoKGVuZHRpbWUtc3RhcnR0aW1lKS8xZTMpO2lmKHN0b3BCZWZvcmVSZWRpcmVjdCgpKXJldHVybjtpZihzdG9wTWF4U3Rha2UoKSlyZXR1cm47aGlnaGVyQmV0KCksY29uc29sZS5sb2cocmVhbHRpbWUoZSkpLGNvbnNvbGUubG9nKCJZb3UgTE9TVCEiKSxtdWx0aXBseSgpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXsyPT1hdXRvVHlwZSYmbF9jPj1tYXhMb3N0JiYoJGF1dG9CdXR0b249JGF1dG9CdXR0b249PSRsb0J1dHRvbj8kaGlCdXR0b246JGxvQnV0dG9uLGxfYz0wKSwkYXV0b0J1dHRvbi50cmlnZ2VyKCJjbGljayIpfSxnZXRSYW5kb21XYWl0KCkpfX0pOw==";
            setTimeout(function () {
                injectScript(source_bot, 'body');
            }, 300);

        }
    });
})();